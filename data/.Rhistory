y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,nrow(y)),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:ncol(y)) lines(1:i,y[1:i,j])
Sys.sleep(0.1)
}
cols<-hcl.colors(n=length(y))
y<-matrix(0,200,100)
cols<-hcl.colors(n=length(y))
for(i in 2:nrow(y)){
X<-sample(c(-1,1),1000,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,nrow(y)),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:ncol(y)) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
y<-matrix(0,200,100)
cols<-hcl.colors(n=length(y))
for(i in 2:nrow(y)){
X<-sample(c(-1,1),ncol(y),replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,nrow(y)),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:ncol(y)) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
y<-matrix(0,200,100)
cols<-hcl.colors(n=ncol(y))
for(i in 2:nrow(y)){
X<-sample(c(-1,1),ncol(y),replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,nrow(y)),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:ncol(y)) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
cols<-make.transparent(hcl.colors(n=ncol(y)),0.5)
cols<-phytools::make.transparent(hcl.colors(n=ncol(y)),0.5)
y<-matrix(0,200,100)
for(i in 2:nrow(y)){
X<-sample(c(-1,1),ncol(y),replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,nrow(y)),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:ncol(y)) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
n<-100
t<-500
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t{
n<-100
t<-500
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.01)
}
dev.off()
n<-100
t<-500
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
hist(y[2,])
hist(y[10,])
hist(y[2,])
for(i in 1:t){
hist(y[2,])
Sys.sleep(0.1)
}
for(i in 1:t){
hist(y[i,])
Sys.sleep(0.1)
}
args(hist)
?hist
for(i in 1:t){
hist(y[i,],
breaks=seq(min(y)-0.5,max(y)+0.5,length.out=20))
Sys.sleep(0.1)
}
for(i in 1:t){
hist(y[i,],
breaks=seq(min(y)-0.5,max(y)+0.5,length.out=20),
xlab="phenotype",main=paste("time =",i))
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-100
t<-500
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
sample(c(-1,1),n,replace=TRUE)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-10
t<-50
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-10
t<-100
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1
t<-200
y<-matrix(0,t,n)
cols<-hcl.colors(n=n)
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
sample(c(-1,1),10,replace=TRUE)
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1 ## number of individuals
t<-200 ## "time" (number of flips)
cols<-hcl.colors(n=n) ## colors
y<-matrix(0,t,n) ## this is where I'm going to put data
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
## Sys.sleep(0.1)
}
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
if(i==t){
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
}
## Sys.sleep(0.1)
}
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
if(i==t){
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
}
## Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1 ## number of individuals
t<-1000 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
if(i==t){
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
}
## Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-10 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
## Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-10 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-10 ## number of individuals
t<-200 ## "time" (number of flips)
## show that Brownian motion evolution can arise
## from coin-flipping
n<-100 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
sample(c(-1,0,1),n,replace=TRUE)
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,0,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
if(i==t){
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-1 ## number of individuals
t<-1000 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,0,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
if(i==t){
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-100 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,0,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
}
## show that Brownian motion evolution can arise
## from coin-flipping
n<-100 ## number of individuals
t<-200 ## "time" (number of flips)
y<-matrix(0,t,n) ## this is where I'm going to put data
cols<-hcl.colors(n=n) ## colors
for(i in 2:t){
X<-sample(c(-1,0,1),n,replace=TRUE)
y[i,]<-y[i-1,]+X
plot(NA,xlim=c(0,t),ylim=range(y),xlab="time",
ylab="phenotype")
for(j in 1:n) lines(1:i,y[1:i,j],col=cols[j])
Sys.sleep(0.1)
}
for(i in 1:t){
hist(y[i,],
breaks=seq(min(y)-0.5,max(y)+0.5,length.out=20),
xlab="phenotype",main=paste("time =",i))
Sys.sleep(0.1)
}
## back to phylogenies
library(phytools)
library(geiger)
## load mammal dataset and tree
?mammal.data
data(mammal.tree)
data(mammal.data)
## review our tree
mammal.tree
## plot our tree
plotTree(mammal.tree,ftype="i",fsize=0.8)
## plot our tree
plotTree(mammal.tree,ftype="i",fsize=0.7)
## review our data
head(mammal.data)
## we could run
name.check(mammal.tree,mammal.data)
## pull out bodyMass
lnBodyMass<-setNames(log(mammal.data$bodyMass),
rownames(mammal.data))
head(lnBodyMass)
## put out home range size
lnHomeRange<-setNames(log(mammal.data$homeRange),
rownames(mammal.data))
head(lnHomeRange)
?pic
## compute PICs for each variable
pic.lnBodyMass<-pic(lnBodyMass,mammal.tree)
pic.lnHomeRange<-pic(lnHomeRange,mammal.tree)
## compute PICs for each variable
pic.lnBodyMass<-pic(lnBodyMass,mammal.tree)
pic.lnHomeRange<-pic(phy=mammal.tree,x=lnHomeRange)
pic.lnBodyMass
## add nodelabels
nodelabels(cex=0.6)
## fit our contrasts regression
mammal_lm<-lm(pic.lnHomeRange~pic.lnBodyMass+0)
mammal_lm
## plot our contrasts
dev.off()
plot(pic.lnBodyMass,pic.lnHomeRange,
pch=16,xlab="contrasts in log(body mass)",
ylab="contrasts in log(home range)",
bty="n",las=1)
grid()
abline(mammal_lm,lwd=2)
## test hypothesis
summary(mammal_lm)
## load another package:nlme
library(nlme)
## preliminaries
spp<-rownames(mammal.data)
spp
## preliminaries
spp<-mammal.tree$tip.label
spp
?corBrownian
corBM<-corBrownian(phy=mammal.tree,form=~spp)
corBM
head(mammal.data)
## fit our mammal PGLS
mammal_pgls<-gls(log(homeRange)~log(bodyMass),
data=mammal.data,correlation=corBM)
mammal_pgls
mammal_lm
ceof(mammal_pgls)
coef(mammal_pgls)
coef(mammal_lm)
## load primate data
data("primate.data")
data("primate.tree")
head(primate.data)
## preliminaries
spp<-primate.tree$tip.label
## preliminaries
spp<-primate.tree$tip.label
corBM<-corBrownian(phy=primate.tree,
form=~spp)
plotTree(primate.tree,ftype="i",fsize=0.6)
plotTree(primate.tree,ftype="i",fsize=0.4)
plotTree(primate.tree,ftype="i",fsize=0.4,lwd=1)
colnames(primate.data)
primate_ancova<-gls(log(Orbit_area)~log(Skull_length)+
Activity_pattern,data=primate.data,
correlation=corBM)
primate_ancova
anova(primate_ancova)
## preliminaries
spp<-rownames(primate.data)
corBM<-corBrownian(phy=primate.tree,
form=~spp)
plotTree(primate.tree,ftype="i",fsize=0.4,lwd=1)
colnames(primate.data)
primate_ancova<-gls(log(Orbit_area)~log(Skull_length)+
Activity_pattern,data=primate.data,
correlation=corBM)
primate_ancova
anova(primate_ancova)
summary(primate_ancova)
x<-fastBM(primate.tree)
## clues
x<-fastBM(primate.tree)
y<-fastBM(primate.tree)
lm_xy<-lm(y~x)
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate_tree))
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate.tree))
lm_xy
lm_pic
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate.tree)+0)
lm_xy
lm_pic
anova(lm_xy)
anova(lm_pic)
for(i in 1:10){
print(i)
}
lm_xy
anova(lm_xy)
str(anova(lm_xy))
i<-1
Pval.pic<-Pval.lm<-vector()
Pval.lm[i]<-anova(lm_xy))$'Pr(>F)'
anova(lm_xy)$'Pr(>F)'
anova(lm_xy)$'Pr(>F)'[1]
anova(lm_pic)
str(anova(lm_pic))
Pval.pic[i]<-anova(lm_pic)'Pr(>F)'
for(i in 1:10){
x<-fastBM(primate.tree)
y<-fastBM(primate.tree)
lm_xy<-lm(y~x)
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate.tree)+0)
Pval.lm[i]<-anova(lm_xy)$'Pr(>F)'[1]
Pval.pic[i]<-anova(lm_pic)$'Pr(>F)'
}
for(i in 1:10){
x<-fastBM(primate.tree)
y<-fastBM(primate.tree)
lm_xy<-lm(y~x)
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate.tree)+0)
Pval.lm[i]<-anova(lm_xy)$'Pr(>F)'[1]
Pval.pic[i]<-anova(lm_pic)$'Pr(>F)'[1]
}
Pval.lm
Pval.pic
Pval.pic<-Pval.lm<-vector()
for(i in 1:100){
x<-fastBM(primate.tree)
y<-fastBM(primate.tree)
lm_xy<-lm(y~x)
lm_pic<-lm(pic(y,primate.tree)~pic(x,primate.tree)+0)
Pval.lm[i]<-anova(lm_xy)$'Pr(>F)'[1]
Pval.pic[i]<-anova(lm_pic)$'Pr(>F)'[1]
}
sum(Pval.pic<0.05)
sum(Pval.lm<0.05)
library(ape)
github.directory <- "https://raw.githubusercontent.com/evolucionario/BigBirdTree/refs/heads/main/"
stage <- "RAGBackbone/"
tree <- "BBtree2.tre"
url <- paste0(github.directory, stage, tree)
BBtree2 <-Â read.tree(url)
library(ape)
github.directory <- "https://raw.githubusercontent.com/evolucionario/BigBirdTree/refs/heads/main/"
stage <- "RAGBackbone/"
tree <- "BBtree2.tre"
url <- paste0(github.directory, stage, tree)
BBtree2 <-read.tree(url)
BBtree2
write.nexus(BBtree2,file="big-bird-tree.nex")
list.files("data/")
fitMk
getwd()
setwd("data")
list.files()
list.files()
contMap
ls()
list.files()
setwd("../ex")
list.files()
setwd("../data")
list.files()
plot.fitPagel
